7 Exploratory Data Analysis | R Data Science Skip main content R Data Science table contents Table contents Welcome 1 Introduction Explore 2 Introduction 3 Data visualisation 4 Workflow : basics 5 Data transformation 6 Workflow : scripts 7 Exploratory Data Analysis 8 Workflow : projects Wrangle 9 Introduction 10 Tibbles 11 Data import 12 Tidy data 13 Relational data 14 Strings 15 Factors 16 Dates times Program 17 Introduction 18 Pipes 19 Functions 20 Vectors 21 Iteration Model 22 Introduction 23 Model basics 24 Model building 25 models Communicate 26 Introduction 27 R Markdown 28 Graphics communication 29 R Markdown formats 30 R Markdown workflow 7 Exploratory Data Analysis reading edition R4DS ; latest topic Exploratory data analysis chapter second edition . 7.1 Introduction chapter use visualisation transformation explore data systematic way , task statisticians exploratory data analysis , EDA short . EDA iterative cycle . : Generate questions data . Search answers visualising , transforming , modelling data . Use learn refine questions and/or generate new questions . EDA formal process strict set rules . , EDA state mind . initial phases EDA feel free investigate idea occurs . ideas pan , dead ends . exploration continues , home particularly productive areas eventually write communicate . EDA important data analysis , questions handed platter , need investigate quality data . Data cleaning application EDA : ask questions data meets expectations . data cleaning , need deploy tools EDA : visualisation , transformation , modelling . 7.1.1 Prerequisites chapter combine learned dplyr ggplot2 interactively ask questions , answer data , ask new questions . library ( tidyverse ) 7.2 Questions “ routine statistical questions , questionable statistical 
 routines . ” — Sir David Cox “ Far better approximate answer right question , 
 vague , exact answer wrong question , 
 precise . ” — John Tukey goal EDA develop understanding data . easiest way use questions tools guide investigation . ask question , question focuses attention specific dataset helps decide graphs , models , transformations . EDA fundamentally creative process . like creative processes , key asking quality questions generate large quantity questions . difficult ask revealing questions start analysis know insights contained dataset . hand , new question ask expose new aspect data increase chance making discovery . quickly drill interesting parts data — develop set thought - provoking questions — follow question new question based find . rule questions ask guide research . , types questions useful making discoveries data . loosely word questions : type variation occurs variables ? type covariation occurs variables ? rest chapter look questions . explain variation covariation , ways answer question . discussion easier , let define terms : variable quantity , quality , property measure . value state variable measure . value 
 variable change measurement measurement . observation set measurements similar conditions 
 ( usually measurements observation 
 time object ) . observation contain values , 
 associated different variable . refer 
 observation data point . Tabular data set values , associated variable 
 observation . Tabular data tidy value placed 
 “ cell ” , variable column , observation 
 row . far , data seen tidy . real - life , data tidy , come ideas tidy data . 7.3 Variation Variation tendency values variable change measurement measurement . variation easily real life ; measure continuous variable twice , different results . true measure quantities constant , like speed light . measurements include small error varies measurement measurement . Categorical variables vary measure different subjects ( e.g.   eye colors different people ) , different times ( e.g.   energy levels electron different moments ) . 
 variable pattern variation , reveal interesting information . best way understand pattern visualise distribution variable values . 7.3.1 Visualising distributions visualise distribution variable depend variable categorical continuous . variable categorical small set values . R , categorical variables usually saved factors character vectors . examine distribution categorical variable , use bar chart : ggplot ( data = diamonds ) + geom_bar ( mapping = aes ( x = cut ) ) height bars displays observations occurred x value . compute values manually dplyr::count ( ) : diamonds % > % count ( cut ) # > # tibble : 5 × 2 # >    cut            n # >    < ord >      < int > # > 1 Fair        1610 # > 2 Good        4906 # > 3 Good 12082 # > 4 Premium    13791 # > 5 Ideal      21551 variable continuous infinite set ordered values . Numbers date - times examples continuous variables . examine distribution continuous variable , use histogram : ggplot ( data = diamonds ) + geom_histogram ( mapping = aes ( x = carat ) , binwidth = 0.5 ) compute hand combining dplyr::count ( ) ggplot2::cut_width ( ) : diamonds % > % count ( cut_width ( carat , 0.5 ) ) # > # tibble : 11 × 2 # >    ` cut_width(carat , 0.5 ) `      n # >    < fct >                    < int > # > 1 [ -0.25,0.25 ]               785 # > 2 ( 0.25,0.75 ]              29498 # > 3 ( 0.75,1.25 ]              15977 # > 4 ( 1.25,1.75 ]               5313 # > 5 ( 1.75,2.25 ]               2002 # > 6 ( 2.25,2.75 ]                322 # > # ℹ 5 rows histogram divides x - axis equally spaced bins uses height bar display number observations fall bin . graph , tallest bar shows 30,000 observations carat value 0.25 0.75 , left right edges bar . set width intervals histogram binwidth argument , measured units x variable . explore variety binwidths working histograms , different binwidths reveal different patterns . example , graph looks zoom diamonds size carats choose smaller binwidth . smaller < - diamonds % > % filter ( carat < 3 ) ggplot ( data = smaller , mapping = aes ( x = carat ) ) + geom_histogram ( binwidth = 0.1 ) wish overlay multiple histograms plot , recommend geom_freqpoly ( ) instead geom_histogram ( ) . geom_freqpoly ( ) performs calculation geom_histogram ( ) , instead displaying counts bars , uses lines instead . easier understand overlapping lines bars . ggplot ( data = smaller , mapping = aes ( x = carat , colour = cut ) ) + geom_freqpoly ( binwidth = 0.1 ) challenges type plot , come visualising categorical continuous variable . visualise variation , look plots ? type follow - questions ask ? list useful types information find graphs , follow - questions type information . key asking good follow - questions rely curiosity ( want learn ? ) skepticism ( misleading ? ) . 7.3.2 Typical values bar charts histograms , tall bars common values variable , shorter bars - common values . Places bars reveal values seen data . turn information useful questions , look unexpected : values common ? ? values rare ? ? match expectations ? unusual patterns ? explain ? example , histogram suggests interesting questions : diamonds carats common fractions carats ? diamonds slightly right peak 
 slightly left peak ? diamonds bigger 3 carats ? ggplot ( data = smaller , mapping = aes ( x = carat ) ) + geom_histogram ( binwidth = 0.01 ) Clusters similar values suggest subgroups exist data . understand subgroups , ask : observations cluster similar ? observations separate clusters different ? explain describe clusters ? appearance clusters misleading ? histogram shows length ( minutes ) 272 eruptions Old Faithful Geyser Yellowstone National Park . Eruption times appear clustered groups : short eruptions ( 2 minutes ) long eruptions ( 4 - 5 minutes ) , little . ggplot ( data = faithful , mapping = aes ( x = eruptions ) ) + geom_histogram ( binwidth = 0.25 ) questions prompt explore relationship variables , example , values variable explain behavior variable . shortly . 7.3.3 Unusual values Outliers observations unusual ; data points fit pattern . outliers data entry errors ; times outliers suggest important new science . lot data , outliers difficult histogram . example , distribution y variable diamonds dataset . evidence outliers unusually wide limits x - axis . ggplot ( diamonds ) + geom_histogram ( mapping = aes ( x = y ) , binwidth = 0.5 ) observations common bins rare bins short ( maybe stare intently 0 spot ) . easy unusual values , need zoom small values y - axis coord_cartesian ( ) : ggplot ( diamonds ) + geom_histogram ( mapping = aes ( x = y ) , binwidth = 0.5 ) + coord_cartesian ( ylim = c ( 0 , 50 ) ) ( coord_cartesian ( ) xlim ( ) argument need zoom x - axis . ggplot2 xlim ( ) ylim ( ) functions work slightly differently : throw away data outside limits . ) allows unusual values : 0 , ~30 , ~60 . pluck dplyr : unusual < - diamonds % > % filter ( y < 3 | y > 20 ) % > % select ( price , x , y , z ) % > % arrange ( y ) unusual # > # tibble : 9 × 4 # >    price      x      y      z # >    < int > < dbl > < dbl > < dbl > # > 1   5139   0       0     0 # > 2   6381   0       0     0 # > 3 12800   0       0     0 # > 4 15686   0       0     0 # > 5 18034   0       0     0 # > 6   2130   0       0     0 # > 7   2130   0       0     0 # > 8   2075   5.15   31.8   5.12 # > 9 12210   8.09   58.9   8.06 y variable measures dimensions diamonds , mm . know diamonds width 0 mm , values incorrect . suspect measurements 32 mm 59 mm implausible : diamonds inch long , cost hundreds thousands dollars ! good practice repeat analysis outliers . minimal effect results , figure , reasonable replace missing values , . , substantial effect results , drop justification . need figure caused ( e.g.   data entry error ) disclose removed write - . 7.3.4 Exercises Explore distribution x , y , z variables 
 diamonds . learn ? Think diamond 
 decide dimension length , width , depth . Explore distribution price . discover unusual 
 surprising ? ( Hint : Carefully think binwidth sure 
 try wide range values . ) diamonds 0.99 carat ? 1 carat ? 
 think cause difference ? Compare contrast coord_cartesian ( ) vs xlim ( ) ylim ( ) 
 zooming histogram . happens leave binwidth unset ? 
 happens try zoom half bar shows ? 7.4 Missing values encountered unusual values dataset , simply want rest analysis , options . Drop entire row strange values : diamonds2 < - diamonds % > % filter ( ( y , 3 , 20 ) ) recommend option measurement 
 invalid , mean measurements . Additionally , 
 low quality data , time applied approach 
 variable find data left ! Instead , recommend replacing unusual values missing values . 
 easiest way use mutate ( ) replace variable 
 modified copy . use ifelse ( ) function replace 
 unusual values NA : diamonds2 < - diamonds % > % mutate ( y = ifelse ( y < 3 | y > 20 , NA , y ) ) ifelse ( ) arguments . argument test logical vector . result contain value second argument , yes , test TRUE , value argument , , false . Alternatively ifelse , use dplyr::case_when ( ) . case_when ( ) particularly useful inside mutate want create new variable relies complex combination existing variables . Like R , ggplot2 subscribes philosophy missing values silently missing . obvious plot missing values , ggplot2 include plot , warn removed : ggplot ( data = diamonds2 , mapping = aes ( x = x , y = y ) ) + geom_point ( ) # > Warning : Removed 9 rows containing missing values values outside scale range # > ( ` geom_point ( ) ` ) . suppress warning , set na.rm = TRUE : ggplot ( data = diamonds2 , mapping = aes ( x = x , y = y ) ) + geom_point ( na.rm = TRUE ) times want understand makes observations missing values different observations recorded values . example , nycflights13::flights , missing values dep_time variable indicate flight cancelled . want compare scheduled departure times cancelled non - cancelled times . making new variable is.na ( ) . nycflights13 : : flights % > % mutate ( cancelled = is.na ( dep_time ) , sched_hour = sched_dep_time % /% 100 , sched_min = sched_dep_time % % 100 , sched_dep_time = sched_hour + sched_min / 60 ) % > % ggplot ( mapping = aes ( sched_dep_time ) ) + geom_freqpoly ( mapping = aes ( colour = cancelled ) , binwidth = 1 / 4 ) plot great non - cancelled flights cancelled flights . section explore techniques improving comparison . 7.4.1 Exercises happens missing values histogram ? happens missing 
 values bar chart ? difference ? na.rm = TRUE mean ( ) sum ( ) ? 7.5 Covariation variation describes behavior variable , covariation describes behavior variables . Covariation tendency values variables vary related way . best way spot covariation visualise relationship variables . depend type variables involved . 7.5.1 categorical continuous variable common want explore distribution continuous variable broken categorical variable , previous frequency polygon . default appearance geom_freqpoly ( ) useful sort comparison height given count . means groups smaller , hard differences shape . example , let explore price diamond varies quality : ggplot ( data = diamonds , mapping = aes ( x = price ) ) + geom_freqpoly ( mapping = aes ( colour = cut ) , binwidth = 500 ) hard difference distribution overall counts differ : ggplot ( diamonds ) + geom_bar ( mapping = aes ( x = cut ) ) comparison easier need swap displayed y - axis . Instead displaying count , display density , count standardised area frequency polygon . ggplot ( data = diamonds , mapping = aes ( x = price , y = .. density .. ) ) + geom_freqpoly ( mapping = aes ( colour = cut ) , binwidth = 500 ) # > Warning : dot - dot notation ( ` .. density .. ` ) deprecated ggplot2 3.4.0 . # > ℹ use ` after_stat(density ) ` instead . # > warning displayed 8 hours . # > ` lifecycle::last_lifecycle_warnings ( ) ` warning # > generated . surprising plot - appears fair diamonds ( lowest quality ) highest average price ! maybe frequency polygons little hard interpret - lot going plot . alternative display distribution continuous variable broken categorical variable boxplot . boxplot type visual shorthand distribution values popular statisticians . boxplot consists : box stretches 25th percentile distribution 
 75th percentile , distance known interquartile range ( IQR ) . 
 middle box line displays median , i.e.   50th percentile , 
 distribution . lines sense spread 
 distribution distribution symmetric 
 median skewed . Visual points display observations fall 1.5 times 
 IQR edge box . outlying points unusual 
 plotted individually . line ( whisker ) extends end box goes farthest non - outlier point distribution . Let look distribution price cut geom_boxplot ( ) : ggplot ( data = diamonds , mapping = aes ( x = cut , y = price ) ) + geom_boxplot ( ) information distribution , boxplots compact easily compare ( fit plot ) . supports counterintuitive finding better quality diamonds cheaper average ! exercises , challenged figure . cut ordered factor : fair worse good , worse good . categorical variables intrinsic order , want reorder informative display . way reorder ( ) function . example , class variable mpg dataset . interested know highway mileage varies classes : ggplot ( data = mpg , mapping = aes ( x = class , y = hwy ) ) + geom_boxplot ( ) trend easier , reorder class based median value hwy : ggplot ( data = mpg ) + geom_boxplot ( mapping = aes ( x = reorder ( class , hwy , FUN = median ) , y = hwy ) ) long variable names , geom_boxplot ( ) work better flip 90 ° . coord_flip ( ) . ggplot ( data = mpg ) + geom_boxplot ( mapping = aes ( x = reorder ( class , hwy , FUN = median ) , y = hwy ) ) + coord_flip ( ) 7.5.1.1 Exercises Use learned improve visualisation departure times 
 cancelled vs.   non - cancelled flights . variable diamonds dataset important predicting 
 price diamond ? variable correlated cut ? 
 combination relationships lead lower quality 
 diamonds expensive ? Install ggstance package , create horizontal boxplot . 
 compare coord_flip ( ) ? problem boxplots developed era 
 smaller datasets tend display prohibitively large 
 number “ outlying values ” . approach remedy problem 
 letter value plot . Install lvplot package , try geom_lv ( ) display distribution price vs cut . 
 learn ? interpret plots ? Compare contrast geom_violin ( ) facetted geom_histogram ( ) , 
 coloured geom_freqpoly ( ) . pros cons 
 method ? small dataset , useful use geom_jitter ( ) relationship continuous categorical variable . 
 ggbeeswarm package provides number methods similar geom_jitter ( ) . List briefly describe . 7.5.2 categorical variables visualise covariation categorical variables , need count number observations combination . way rely built - geom_count ( ) : ggplot ( data = diamonds ) + geom_count ( mapping = aes ( x = cut , y = color ) ) size circle plot displays observations occurred combination values . Covariation appear strong correlation specific x values specific y values . approach compute count dplyr : diamonds % > % count ( color , cut ) # > # tibble : 35 × 3 # >    color cut            n # >    < ord > < ord >      < int > # > 1 D      Fair         163 # > 2 D      Good         662 # > 3 D      Good   1513 # > 4 D      Premium     1603 # > 5 D      Ideal       2834 # > 6 E      Fair         224 # > # ℹ 29 rows visualise geom_tile ( ) fill aesthetic : diamonds % > % count ( color , cut ) % > % ggplot ( mapping = aes ( x = color , y = cut ) ) + geom_tile ( mapping = aes ( fill = n ) ) categorical variables unordered , want use seriation package simultaneously reorder rows columns order clearly reveal interesting patterns . larger plots , want try d3heatmap heatmaply packages , create interactive plots . 7.5.2.1 Exercises rescale count dataset clearly 
 distribution cut colour , colour cut ? Use geom_tile ( ) dplyr explore average flight 
 delays vary destination month year . makes 
 plot difficult read ? improve ? slightly better use aes(x = color , y = cut ) 
 aes(x = cut , y = color ) example ? 7.5.3 continuous variables seen great way visualise covariation continuous variables : draw scatterplot geom_point ( ) . covariation pattern points . example , exponential relationship carat size price diamond . ggplot ( data = diamonds ) + geom_point ( mapping = aes ( x = carat , y = price ) ) Scatterplots useful size dataset grows , points begin overplot , pile areas uniform black ( ) . 
 seen way fix problem : alpha aesthetic add transparency . ggplot ( data = diamonds ) + geom_point ( mapping = aes ( x = carat , y = price ) , alpha = 1 / 100 ) transparency challenging large datasets . solution use bin . Previously geom_histogram ( ) geom_freqpoly ( ) bin dimension . learn use geom_bin2d ( ) geom_hex ( ) bin dimensions . geom_bin2d ( ) geom_hex ( ) divide coordinate plane 2d bins use fill color display points fall bin . geom_bin2d ( ) creates rectangular bins . geom_hex ( ) creates hexagonal bins . need install hexbin package use geom_hex ( ) . ggplot ( data = smaller ) + geom_bin2d ( mapping = aes ( x = carat , y = price ) ) # install.packages("hexbin " ) ggplot ( data = smaller ) + geom_hex ( mapping = aes ( x = carat , y = price ) ) option bin continuous variable acts like categorical variable . use techniques visualising combination categorical continuous variable learned . example , bin carat group , display boxplot : ggplot ( data = smaller , mapping = aes ( x = carat , y = price ) ) + geom_boxplot ( mapping = aes ( group = cut_width ( carat , 0.1 ) ) ) cut_width(x , width ) , , divides x bins width width . default , boxplots look roughly ( apart number outliers ) regardless observations , difficult tell boxplot summarises different number points . way width boxplot proportional number points varwidth = TRUE . approach display approximately number points bin . job cut_number ( ) : ggplot ( data = smaller , mapping = aes ( x = carat , y = price ) ) + geom_boxplot ( mapping = aes ( group = cut_number ( carat , 20 ) ) ) 7.5.3.1 Exercises Instead summarising conditional distribution boxplot , 
 use frequency polygon . need consider cut_width ( ) vs cut_number ( ) ? impact visualisation 
 2d distribution carat price ? Visualise distribution carat , partitioned price . price distribution large diamonds compare small 
 diamonds ? expect , surprise ? Combine techniques learned visualise 
 combined distribution cut , carat , price . dimensional plots reveal outliers visible 
 dimensional plots . example , points plot 
 unusual combination x y values , makes points outliers 
 x y values appear normal examined separately . ggplot ( data = diamonds ) + geom_point ( mapping = aes ( x = x , y = y ) ) + coord_cartesian ( xlim = c ( 4 , 11 ) , ylim = c ( 4 , 11 ) ) scatterplot better display binned plot case ? 7.6 Patterns models Patterns data provide clues relationships . systematic relationship exists variables appear pattern data . spot pattern , ask : pattern coincidence ( i.e.   random chance ) ? describe relationship implied pattern ? strong relationship implied pattern ? variables affect relationship ? relationship change look individual subgroups data ? scatterplot Old Faithful eruption lengths versus wait time eruptions shows pattern : longer wait times associated longer eruptions . scatterplot displays clusters noticed . ggplot ( data = faithful ) + geom_point ( mapping = aes ( x = eruptions , y = waiting ) ) Patterns provide useful tools data scientists reveal covariation . think variation phenomenon creates uncertainty , covariation phenomenon reduces . variables covary , use values variable better predictions values second . covariation causal relationship ( special case ) , use value variable control value second . Models tool extracting patterns data . example , consider diamonds data . hard understand relationship cut price , cut carat , carat price tightly related . possible use model remove strong relationship price carat explore subtleties remain . following code fits model predicts price carat computes residuals ( difference predicted value actual value ) . residuals view price diamond , effect carat removed . library ( modelr ) mod < - lm ( log ( price ) ~ log ( carat ) , data = diamonds ) diamonds2 < - diamonds % > % add_residuals ( mod ) % > % mutate ( resid = exp ( resid ) ) ggplot ( data = diamonds2 ) + geom_point ( mapping = aes ( x = carat , y = resid ) ) removed strong relationship carat price , expect relationship cut price : relative size , better quality diamonds expensive . ggplot ( data = diamonds2 ) + geom_boxplot ( mapping = aes ( x = cut , y = resid ) ) learn models , modelr package , work final book , model . saving modelling later understanding models work easiest tools data wrangling programming hand . 7.7 ggplot2 calls introductory chapters , transition concise expression ggplot2 code . far explicit , helpful learning : ggplot ( data = faithful , mapping = aes ( x = eruptions ) ) + geom_freqpoly ( binwidth = 0.25 ) Typically , arguments function important know heart . arguments ggplot ( ) data mapping , arguments aes ( ) x y . remainder book , wo supply names . saves typing , , reducing boilerplate , makes easier different plots . important programming concern come functions . Rewriting previous plot concisely yields : ggplot ( faithful , aes ( eruptions ) ) + geom_freqpoly ( binwidth = 0.25 ) turn end pipeline data transformation plot . Watch transition % > % + . wish transition necessary unfortunately ggplot2 created pipe discovered . diamonds % > % count ( cut , clarity ) % > % ggplot ( aes ( clarity , cut , fill = n ) ) + geom_tile ( ) 7.8 Learning want learn mechanics ggplot2 , highly recommend grabbing copy ggplot2 book : https://amzn.com/331924275X . recently updated , includes dplyr tidyr code , space explore facets visualisation . Unfortunately book generally available free , connection university probably electronic version free SpringerLink . useful resource R Graphics Cookbook Winston Chang . contents available online http://www.cookbook-r.com/Graphs/ . recommend Graphical Data Analysis R , Antony Unwin . book - length treatment similar material covered chapter , space greater depth . 6 Workflow : scripts 8 Workflow : projects page 7 Exploratory Data Analysis 7.1 Introduction 7.1.1 Prerequisites 7.2 Questions 7.3 Variation 7.3.1 Visualising distributions 7.3.2 Typical values 7.3.3 Unusual values 7.3.4 Exercises 7.4 Missing values 7.4.1 Exercises 7.5 Covariation 7.5.1 categorical continuous variable 7.5.2 categorical variables 7.5.3 continuous variables 7.6 Patterns models 7.7 ggplot2 calls 7.8 Learning " R Data Science " written Hadley Wickham Garrett Grolemund . book built bookdown R package .